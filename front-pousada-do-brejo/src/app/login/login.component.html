<div
  class="min-h-[100dvh] w-screen flex items-center justify-center px-4 sm:px-6 lg:px-8
         bg-[var(--bg-color)] transition-colors"
>
  <div
    class="w-full max-w-6xl mx-auto flex flex-col lg:flex-row items-center justify-center gap-y-10 lg:gap-x-16"
  >
    <div class="flex items-center justify-center lg:flex-1">
      <img
        [src]="logoSrc"
        alt="Pousada do Brejo"
        class="w-56 sm:w-72 md:w-80 lg:w-96 h-auto drop-shadow-xl transition-all"
      />
    </div>

    <div
      class="rounded-2xl shadow-2xl p-6 md:p-10 w-full max-w-xs lg:flex-1 lg:max-w-sm
             bg-[var(--bg-card)]/95 backdrop-blur-sm border border-[var(--border-color)]"
    >
      <h1 class="text-3xl font-extrabold mb-8 text-center text-[var(--text-color)]">
        Login
      </h1>

      <form #form="ngForm" (ngSubmit)="onSubmit(form)" novalidate>
        <!-- Usuário -->
        <div class="mb-5">
          <label
            for="usuario"
            class="block text-sm font-medium mb-2 text-[var(--text-dim)]"
            >E-mail, telefone ou usuário</label
          >
          <input
            id="usuario"
            name="usuario"
            type="text"
            [(ngModel)]="usuario"
            #usuarioCtrl="ngModel"
            required
            maxlength="50"
            (blur)="usuario = usuario.trim()"
            autocomplete="username"
            class="w-full rounded-xl border border-[var(--border-color)]
                   focus:border-[var(--accent-yellow)]
                   focus:ring-4 focus:ring-[var(--accent-yellow)]/20
                   outline-none px-4 py-3 transition
                   bg-[var(--bg-color)] text-[var(--text-color)]
                   placeholder:text-[var(--text-dim)]/60"
            placeholder="seu@email.com • (xx) xxxxx-xxxx • seu.usuario"
          />
          <div
            class="mt-2 text-sm text-red-500 min-h-[20px]"
            *ngIf="form.submitted || usuarioCtrl.touched"
          >
            <p *ngIf="usuarioCtrl.errors?.['required']">
              Informe seu e-mail, telefone ou usuário.
            </p>
            <p *ngIf="usuarioCtrl.errors?.['maxlength']">
              Identificador deve ter no máximo 50 caracteres.
            </p>
          </div>
        </div>

        <!-- Senha -->
        <div class="mb-2">
          <label
            for="senha"
            class="block text-sm font-medium mb-2 text-[var(--text-dim)]"
            >Senha</label
          >

          <div class="relative">
            <input
              id="senha"
              name="senha"
              [type]="mostrarSenha ? 'text' : 'password'"
              [(ngModel)]="senha"
              #senhaCtrl="ngModel"
              required
              maxlength="50"
              (blur)="senha = senha.trim()"
              autocomplete="current-password"
              class="w-full rounded-xl border border-[var(--border-color)]
                     focus:border-[var(--accent-yellow)]
                     focus:ring-4 focus:ring-[var(--accent-yellow)]/20
                     outline-none px-4 py-3 pr-12 transition
                     bg-[var(--bg-color)] text-[var(--text-color)]
                     placeholder:text-[var(--text-dim)]/60"
              placeholder="Digite sua senha"
            />

            <!-- Botão ver/ocultar senha -->
            <button
              type="button"
              (click)="toggleSenha()"
              class="absolute inset-y-0 right-3 flex items-center
                     text-[var(--text-dim)] hover:text-[var(--text-color)] transition"
              aria-label="Mostrar ou ocultar senha"
            >
              <!-- Olho aberto -->
              <svg
                *ngIf="!mostrarSenha"
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943
                     9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                />
                <circle cx="12" cy="12" r="3" stroke-width="2"></circle>
              </svg>

              <!-- Olho fechado -->
              <svg
                *ngIf="mostrarSenha"
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7
                     a9.97 9.97 0 012.223-3.592M6.18 6.18A9.956 9.956 0 0112 5
                     c4.478 0 8.268 2.943 9.542 7a9.97 9.97 0 01-1.82 3.09M3 3l18 18"
                />
              </svg>
            </button>
          </div>

          <div
            class="mt-2 text-sm text-red-500 min-h-[20px]"
            *ngIf="(form.submitted || senhaCtrl.touched) && senhaCtrl.errors"
          >
            <p *ngIf="senhaCtrl.errors['required']">Senha é obrigatória.</p>
            <p *ngIf="senhaCtrl.errors['maxlength']">
              Senha deve ter no máximo 50 caracteres.
            </p>
          </div>
        </div>

        <!-- Botão Entrar -->
        <button
          type="submit"
          [disabled]="isLoading"
          [attr.aria-disabled]="isLoading ? true : null"
          class="w-full mt-8 bg-[var(--accent-yellow,#facc15)] text-[#111827]
                 hover:brightness-110 font-semibold py-3.5 rounded-xl shadow-lg
                 transition-all duration-300 transform hover:-translate-y-0.5 hover:shadow-2xl
                 disabled:cursor-not-allowed disabled:opacity-70 flex items-center justify-center gap-2"
        >
          <svg
            *ngIf="isLoading"
            class="animate-spin h-5 w-5"
            viewBox="0 0 24 24"
            fill="none"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              d="M4 12a8 8 0 018-8v4"
              stroke="currentColor"
              stroke-width="4"
              stroke-linecap="round"
            ></path>
          </svg>
          <span>{{ isLoading ? 'Entrando...' : 'Entrar' }}</span>
        </button>

        <!-- Esqueceu a senha -->
        <div class="text-center mt-6">
          <button
            type="button"
            (click)="abrirRecuperar()"
            class="text-sm text-[var(--text-color)] hover:underline focus:outline-none
                   focus:ring-2 focus:ring-offset-2 focus:ring-[var(--accent-yellow)] rounded"
          >
            Esqueceu a senha?
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- MODAL "ESQUECEU A SENHA" -->
<div
  *ngIf="showRecuperar"
  class="fixed inset-0 z-50 flex items-center justify-center px-4"
  (click)="onBackdropClick($event)"
  role="presentation"
>
  <!-- Backdrop -->
  <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>

  <!-- Card -->
  <div
    class="relative max-w-sm w-full rounded-2xl bg-[var(--bg-card)]
           border border-[var(--border-color)] shadow-2xl p-6
           text-[var(--text-color)]"
    role="dialog"
    aria-modal="true"
    aria-labelledby="recuperar-title"
    tabindex="-1"
    (click)="$event.stopPropagation()"
  >
    <div class="flex items-start justify-between gap-3 mb-4">
      <h2
        id="recuperar-title"
        class="text-lg font-semibold text-[var(--text-color)]"
      >
        Recuperar senha
      </h2>
      <button
        type="button"
        (click)="fecharRecuperar()"
        class="text-[var(--text-dim)] hover:text-[var(--text-color)]"
        aria-label="Fechar"
      >
        ✕
      </button>
    </div>

    <p class="text-sm leading-relaxed text-[var(--text-dim)] mb-4">
      Esta funcionalidade ainda está em desenvolvimento e estamos trabalhando
      para disponibilizá-la o mais rápido possível.
    </p>
    <p class="text-sm leading-relaxed text-[var(--text-dim)] mb-6">
      Enquanto isso, entre em contato com um <span class="font-semibold">administrador</span> ou com o
      <span class="font-semibold">desenvolvedor do sistema</span> para que possam
      redefinir sua senha manualmente.
    </p>

    <div class="flex justify-end">
      <button
        type="button"
        (click)="fecharRecuperar()"
        class="px-4 py-2 rounded-xl text-sm font-medium
               bg-[var(--accent-yellow,#facc15)] text-[#111827]
               hover:brightness-110 transition"
      >
        Entendi
      </button>
    </div>
  </div>
</div>
